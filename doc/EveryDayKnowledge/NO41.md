# 每天一个小知识点

## 第四十一天

---

## vue 虚拟 dom 的解析过程

- 首先对将要插入到文档中的 DOM 树结构进行分析,使用 js 对象将其表示出来,比如一个元素对象,包含 TagName、props 和 children 这些属性。然后将这个 js 对象给保存下来,最后再将 DOM 片段插入到文档中。
- 当页面的状态发生变化,需要对页面的 DOM 的结构进行调整的时候,首先根据变更的状态,重新构建起一棵对象树,然后将这棵树和旧的对象树进行比较,记录下两棵树的差异
- 最后将记录的有差异的地方应用到真正的 DOM 树中去,这样视图就更新了

## 为什么要用虚拟 dom

- 保证性能下限,在不进行手动优化的情况下,提供过得去的性能
  页面渲染的流程: 解析 HTML->生成 DOM->生成 CSSOM->Layout->Paint->compiler  
   修改虚拟 DOM 和真实 DOM 的过程:  
   真实 DOM：生成 HTML 字符串 + 重建所有的 DOM 元素  
   虚拟 DOM：生成 VNode + DOMDiff + 必要的 dom 更新  
  虚拟 dom 的更新准备工作耗费更多的时间,即在 js 层面,相比于更多的 DOM 操作它的消费是极其便宜的
- 虚拟 dom 本质上是 js 对象,它可以很方便的跨平台操作,比如服务端渲染、uniapp 等

## 虚拟 dom 真的比真实 dom 性能好吗

- 首次渲染大量 DOM 时,由于多了一层虚拟 DOM 计算,会比 innerHTML 插入慢
- 正如它能保证性能下限,在真实 DOM 操作的时候进行针对性的优化时,还是更快的
